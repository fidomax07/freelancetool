@using Microsoft.AspNetCore.Builder
@using Microsoft.AspNetCore.Localization
@using Microsoft.AspNetCore.Mvc.Localization
@using Microsoft.Extensions.Options

@inject IViewLocalizer Localizer
@inject IOptions<RequestLocalizationOptions> LocOptions
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
	var requestCulture = Context.Features.Get<IRequestCultureFeature>();
	var cultureItems = LocOptions.Value.SupportedUICultures
		//.Where(c => c.Name != "en")
		.Select(c => new SelectListItem { Value = c.Name, Text = c.DisplayName })
		.ToList();
	var returnUrl = string.IsNullOrEmpty(Context.Request.Path) ?
		"~/" : $"~{Context.Request.Path.Value}";
	var currentCulture = requestCulture.RequestCulture.UICulture;
	var deCulture = LocOptions.Value.SupportedUICultures
		.SingleOrDefault(c => c.Name == "de");
	var frCulture = LocOptions.Value.SupportedUICultures
		.SingleOrDefault(c => c.Name == "fr");
}

<div class="row">
	<div class="col-md-10 col-md-offset-1">
		<div title="@Localizer["Request culture provider:"] @requestCulture?.Provider?.GetType().Name"
			 class="pull-right language-select-container">
			<form id="language-select-form" method="post" class="form-horizontal" role="form"
				  style="display: none;"
				  asp-controller="Home"
				  asp-action="SetLanguage"
				  asp-route-returnUrl="@Context.Request.Path">
				@*@Localizer["Language:"]*@
				@*<select name="culture"
						asp-for="@requestCulture.RequestCulture.UICulture.Name"
						asp-items="cultureItems">
					</select>*@
				<input type="hidden" name="culture" id="language-select-culture" />
				<input type="hidden" id="language-select-current-culture"
					   value="@currentCulture.Name" />
			</form>
			<a href="javascript:void(0);"
			   class="language-select-provider 
					@(currentCulture.Name == deCulture?.Name ? " language-select-focus" : "")"
			   data-culture-name="@deCulture?.Name">German |</a>
			<a href="javascript:void(0);"
			   class="language-select-provider
					@(currentCulture.Name == frCulture?.Name ? " language-select-focus" : "")"
			   data-culture-name="@frCulture?.Name">French</a>
			
			@* Logout link for Admin area only *@
			@if (SignInManager.IsSignedIn(User))
			{
				<form asp-area="" asp-controller="Account" asp-action="Logout"
					  method="post" id="logoutForm" class="pull-right"
					  style="display: none;"></form>
				<a href="javascript:void(0);" class="btn btn-link logout-button" id="logoutButton">
					Log out
				</a>
			}
		</div>
	</div>
</div>


